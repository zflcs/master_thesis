# 基于执行流的软硬件统一任务模型

执行流：逻辑上独立且具有明确控制结构的功能单元。

## 基于执行流的软件任务模型

描述见论文[第三章](../thesis.pdf)

## 基于执行流的硬件任务模型

随着计算机技术的进一步发展，软硬件结合的发展趋势日益明显，许多研究将软件中耗时的任务卸载到硬件上，由硬件的并行电路逻辑来快速处理（例如将网络协议的处理卸载到智能网卡中），从而降低系统的开销。在基于执行流的软件任务模型中，地址空间和特权级描述了任务所处的动态环境，堆栈描述了任务的函数调用关系等与其功能逻辑相关的信息。同理，硬件的并行电路提供的功能单元也处于某个特定的环境中，在接收到事件（电平、脉冲等）后执行其功能逻辑。因此，本文从软硬件交互的角度出发，将硬件实现的并行电路也视为执行流（逻辑上独立且具有明确控制结构的功能单元），构建了基于执行流的硬件任务模型，并使用 $T_{(P_{i}, L_{j}, H_{k})}$ 对其进行符号化表示：

- $P_{i}$：表示硬件任务所处的进程（地址空间），$P_{i}$ 可以是内核，也可以是某个进程；
- $L_{j}$：表示硬件任务运行的特权级，$L_{j}$ 可以是用户态、内核态或其他特权级；以网卡为例，当网卡的 I/O 端口以及相关的寄存器端口被映射到内核地址空间中，且其对应的驱动任务运行在内核态下，则网卡硬件中的并行电路（网卡的硬件任务）同样处于内核地址空间和内核态中；同理，若网卡的 I/O 端口以及相关的寄存器端口被映射到进程地址空间中，并且应用程序在用户态的网卡驱动任务来控制网卡的行为，则网卡的硬件任务运行于进程的地址空间和用户态中；**CPU 中负责切换地址空间和特权级的电路逻辑属于特殊的硬件任务，它会跨越地址空间或特权级，存在多种符号化表示（这里特殊化，后面怎么解释，还是不对其进行建模呢）**；
- $H_{k}$：表示硬件任务的控制结构（电路逻辑，包括时序电路、组合电路等）；

硬件任务之间的切换可以使用三元组（$[prev]\longrightarrow [next] : \{condition\}$）进行描述，其中 $prev$、$next$ 分别表示硬件中两个相互独立的实现不同功能的电路逻辑，$condition$ 表示切换的条件，可以为硬件中的某个寄存器的值发生变化、某个端口的电平发生变化等。
